---
title: DataDictionary.xlsm and the exceldata package
subtitle: "Data Entry Guidelines"
output: rmarkdown::html_vignette
sansfont: Calibri Light
mainfont: Calibri Light
vignette: >
  %\VignetteIndexEntry{Data_Entry_Guidelines}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(exceldata)
```

- Enter the Levels of categorical and code variables in the order you would like them presented in (ie CR=complete recovery, PR=partial recovery,SD=stable disease,PD=progressive disease,NE=not evaluated)

- Long survey questions should be placed in the description. Under the variable name, either a shortened version, or simply Q1, Q2, etc.

- Do not group variables using rows at the top. Instead, give the variables a similar prefix. For instance, if you want to look at pre and post treatment conditions you can you pre_stage, pre_ecog and corresponding post_stage, post_ecog variables for after treatment. 

- All date, integer and numeric values should have ranges specified. These should correspond to inclusion and exclusion criteria for your study, or natural values the variable can take. If you don't know the upper limit (ie of a biomarker), then put in the maximum reasonable value. Values above this will be flagged and you can adjust the maximum to include them if you wish.

- If you need to adjust the range values (maximum, minimum or allowed codes) then make the changes in the DataDictionary and then run the `Re-format Existing` Sheet macro. This will update the validation rules and conditional formatting to reflect the new ranges.

My data is already in an Excel list from an online capture system, do I still need to enter the specifications?

> Yes, but this should be pretty quick. The reason that we need the specifications is to know the appropriate ordering for the data. When the data is imported, a variable with levels such as 0-2 years, 3-5 years, 5-10 years and 10+ years can't be ordered correctly without a specification. You can use the UNIQUE function in Excel to extract all the unique values from a column (ie =UNIQUE(A2:A50) to get the unique values in column A up to row 50).


I have a lot of variables and I don't want to enter specifications for all of them!

> It is essential to provide specification for all your variables, but here are some tips to help: 
  1. Include only the variables you would like analysed in your DataDictionary. 
  1. If you still have a lot of variables, it is likely that a number of them will have the same type and range, so you can copy and paste those to save time. 
  1. If you have a lot of variables with spaces or special characters, place the original variable name in the description field, and give your variables simple names - these can be as simple as q1, q2, etc (you don't need to type those, Excel will allow you to highlight a few and then drag down automatically renaming to q3, q4 etc). 
