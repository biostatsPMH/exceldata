<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 importExcelData Sub- Functions | Using the DataDictionary template and the exceldata package</title>
  <meta name="description" content="3.2 importExcelData Sub- Functions | Using the DataDictionary template and the exceldata package" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 importExcelData Sub- Functions | Using the DataDictionary template and the exceldata package" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 importExcelData Sub- Functions | Using the DataDictionary template and the exceldata package" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="importexceldata.html"/>
<link rel="next" href="plotvariables.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> &nbsp;&nbsp; exceldata    </li>
<li> &nbsp;&nbsp; PMH Biostatistics</li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workflow and Biostatistics</a></li>
<li class="chapter" data-level="2" data-path="the-datadictionary-xlsm-file.html"><a href="the-datadictionary-xlsm-file.html"><i class="fa fa-check"></i><b>2</b> The DataDictionary.xlsm file</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-dictionary.html"><a href="data-dictionary.html"><i class="fa fa-check"></i><b>2.1</b> Data Dictionary</a></li>
<li class="chapter" data-level="2.2" data-path="variable-types.html"><a href="variable-types.html"><i class="fa fa-check"></i><b>2.2</b> Variable Types</a></li>
<li class="chapter" data-level="2.3" data-path="calculated-variables.html"><a href="calculated-variables.html"><i class="fa fa-check"></i><b>2.3</b> Calculated Variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="calculated-variables.html"><a href="calculated-variables.html#survival-variables"><i class="fa fa-check"></i><b>2.3.1</b> Survival Variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="calculated-variables.html"><a href="calculated-variables.html#recoded-variables"><i class="fa fa-check"></i><b>2.3.2</b> Recoded Variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="calculated-variables.html"><a href="calculated-variables.html#categorised-variables"><i class="fa fa-check"></i><b>2.3.3</b> Categorised Variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="calculated-variables.html"><a href="calculated-variables.html#combined-variables"><i class="fa fa-check"></i><b>2.3.4</b> Combined Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-entry.html"><a href="data-entry.html"><i class="fa fa-check"></i><b>2.4</b> Data Entry</a></li>
<li class="chapter" data-level="2.5" data-path="multiple-data-sheets.html"><a href="multiple-data-sheets.html"><i class="fa fa-check"></i><b>2.5</b> Multiple Data Sheets</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-exceldata-package.html"><a href="the-exceldata-package.html"><i class="fa fa-check"></i><b>3</b> The exceldata package</a>
<ul>
<li class="chapter" data-level="3.1" data-path="importexceldata.html"><a href="importexceldata.html"><i class="fa fa-check"></i><b>3.1</b> importExcelData</a></li>
<li class="chapter" data-level="3.2" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html"><i class="fa fa-check"></i><b>3.2</b> importExcelData Sub- Functions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html#import-the-data-dictionary"><i class="fa fa-check"></i><b>3.2.1</b> Import the Data Dictionary</a></li>
<li class="chapter" data-level="3.2.2" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html#import-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Import the Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html#perform-checks"><i class="fa fa-check"></i><b>3.2.3</b> Perform Checks</a></li>
<li class="chapter" data-level="3.2.4" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html#create-factor-variables"><i class="fa fa-check"></i><b>3.2.4</b> Create Factor Variables</a></li>
<li class="chapter" data-level="3.2.5" data-path="importexceldata-sub-functions.html"><a href="importexceldata-sub-functions.html#create-calculated-variables"><i class="fa fa-check"></i><b>3.2.5</b> Create Calculated Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="plotvariables.html"><a href="plotvariables.html"><i class="fa fa-check"></i><b>3.3</b> PlotVariables</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="mailto:lisa.avery@uhnresearch.ca">Lisa Avery</a>   </li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using the DataDictionary template and the exceldata package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="importexceldata-sub--functions" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> importExcelData Sub- Functions</h2>
<div id="import-the-data-dictionary" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Import the Data Dictionary</h3>
<p>The <code>readDataDict</code> function will import the dictionary file. This is slightly more useful than just using <code>readxl::read_excel</code> because checks will be performed to ensure the dictionary is complete and dates will be converted to easy to read text strings.</p>
<p>The file and sheet name must be specified.</p>
<p>Optional Arguments:</p>
<ul>
<li><code>colnames</code> Column names of the DataDictionary, defaults to those used in the Excel template</li>
<li><code>range</code> allows a specified range of the sheet to be imported (ie range = “A1:F10”)</li>
<li><code>origin</code> enables the origin of Excel dates to be set (defaults to 30 December 1899)</li>
</ul>
<p><strong>!<code>readDataDict</code> must be run before <code>readExcelData</code></strong></p>
</div>
<div id="import-the-data" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Import the Data</h3>
<p>The <code>readExcelData</code> function will import the data, using the specifications provided in the data dictionary. Again, this should be slightly more useful than a readxl::read_excel because:</p>
<ul>
<li>dates will be imported nicely</li>
<li>variables not in the data dictionary will be removed</li>
<li>there is an option to store any import warnings, which may be useful to send to the user</li>
<li>the data can be read in ‘strictly’, setting all values that fall outside the allowed range to <code>NA</code> (This can be useful if users insist on using missing value codes)</li>
</ul>
<p>The file and sheetname, as well as the object returned by the <code>readDataDict</code> function must be specified.</p>
<p>Optional Arguments:</p>
<ul>
<li><code>range</code> allows a specified range of the sheet to be imported (ie range = “A1:AB102”)</li>
<li><code>origin</code> enables the origin of Excel dates to be set (defaults to 30 December 1899)</li>
<li><code>saveWarnings</code> will return a list with the data frame and the import warnings (if there are any)</li>
<li><code>setErrorsMissing</code> will set all values out of range to <code>NA</code> <strong>this should only be done if no warnings are given</strong></li>
</ul>
</div>
<div id="perform-checks" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Perform Checks</h3>
<p>The <code>checkData</code> function will simply check the data against the data dictionary. This requires the outputs of <code>readDataDict</code> and <code>readExcelData</code>.</p>
<p>The <code>checkData</code> function will check for duplicate rows and check that all numeric, integer, date, code and category variables meet the requirements of the data dictionary. It does not check the data types, because these are enforced by the <code>readExcelData</code> function.</p>
<p>The outputs from <code>readDataDict</code> and <code>readExcelData</code> are required.</p>
<p>Optional Argument:</p>
<ul>
<li>id can be used to indicate the patient identifier (ie id =‘SubjectID’) which will provide errors for each id, instead of by row number</li>
</ul>
<p><code>checkData</code> returns a list with three elements:</p>
<ul>
<li><p>a data frame containiny all the errors (rows and columns without errors are removed)</p></li>
<li><p>a two-column data frame with Variable Names in one column and the location of errors in the second (either row numbers or IDs if provided)</p></li>
<li><p>a two-column data frame with Row Numbers (or IDs) in one columns and the variable containing errors in the second column.</p></li>
</ul>
</div>
<div id="create-factor-variables" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Create Factor Variables</h3>
<p>The <code>addFactorVariables</code> function will rename all the code and category variables suffixed with <code>_orig</code> (so <em>ecog</em> becomes <em>ecog_orig</em>) and create factor variables using the codes provided in the data dictionary as the factor levels and labels.</p>
</div>
<div id="create-calculated-variables" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Create Calculated Variables</h3>
<p>The ‘createCalculated’ function calculated variables according the specifications given in the data dictionary. For recoded variables a contingency table is exported to the log file to ensure the categories have been created as expected. For categorised variables a table with the minimum and maximum values on the continuous variable is given for each category and also exported to the log file. For combined variables an atribute is tagged onto the variable so that it is printed as a Pareto graph by the <code>PlotVariables</code> function.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importexceldata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotvariables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none",
"toc_depth": 3,
"scroll_highlight": true,
"toolbar": null,
"position": "fixed"
},
"search": true,
"info": false
});
});
</script>

</body>

</html>
