[["index.html", "Using the DataDictionary template and the exceldata package 1 Workflow and Biostatistics", " Using the DataDictionary template and the exceldata package 1 Workflow and Biostatistics The DataDictionary0.5.xlsm template contains a DataDictionary sheet and macros to create and format a corresponding DataEntry sheet to facilitate low-level data cleaning and data checking. The exceldata package contains functions for processing Excel files created with the DataDictionary0.5.xlsm template. Integration of the Excel Data Dictionary and the excelData package "],["the-datadictionary-xlsm-file.html", "2 The DataDictionary.xlsm file", " 2 The DataDictionary.xlsm file The purpose of the DataDictionary is to facilitate high-quality data entry. This is achieved by pairing dictionary sheets, which contain information about the type of data with data entry sheets that store the actual data. Even if the data are already entered, the user can create a dictionary and a data entry table and then copy existing data into the table for error highlighting. Workflow of the DataDictionary0.5.xlsm template "],["data-dictionary.html", "2.1 Data Dictionary", " 2.1 Data Dictionary Example of a DataDictionary A user begins by specifying the name, type and allowed range (or values) for each variable. They then create a data entry sheet, by clicking the Create Data Entry Sheet button, which runs a macro to check that the dictionary is complete before generating a data entry sheet with data validation rules and conditional formatting. "],["variable-types.html", "2.2 Variable Types", " 2.2 Variable Types There are seven allowed types of variables: calculated for variables where users specify calculations to be performed (age groups, overall survival) category for variables which can take only pre-specified values character for variables such as the id, or any variable not to be analysed codes for variables where short forms are entered (ie 1=male, 2=female) date for all dates integer for values which can take only whole numbers (ECOG score) numeric for all other numeric values For the date, integer and numeric types the user must specify both a minimum and a maximum value. The minimum and maximum values can be numeric, the names of other variables in the data (if you want to make sure death is after diagnosis) or, for date types, today can be used to allow all dates up to the time of entry. For the codes and category variables the user needs to specify the allowed categories, or the codes, in the order they would like them presented. If they struggle with this for data that has already been entered, then the UNIQUE function in Excel may be of use to them, it will list all the unique variables in a range. Once the dictionary is complete clicking the the Create Data Entry Sheet button will create the data entry table. If the user wishes to change any of the ranges or codes after entering data then they can change the dictionary and click Re-format Exising Sheet to update the validaion rules. If code or category variables are present then a _codes_ sheet will be created to contain the allowed values for data validation. This sheet contains the same name as the data entry sheet, suffixed by codes. This sheet is hidden from the user. "],["data-entry.html", "2.3 Data Entry", " 2.3 Data Entry A Data Entry Table The data entry table contains data validation rules (with prompts) and conditional formatting to highlight cells that fall outside the allowed range of the variable. Users can not enter data outside the allowed range, but they can copy it in from another source. If a user performs a regular paste (Ctrl+V) then the validation and formatting will be over-written. If this happens, then users should click the Re-format Existing Sheet button on the data dictionary sheet. This will re-read all the values in the dictionary and re-apply formatting to the data entry sheet. This is also useful if the user changes the ranges of variables. Once the data entry is complete, the user should click Re-format Existing Sheet to ensure all formats are up to date and all values are checked before sending to the Biostatistics department. Workflow of the DataDictionary.xlsm file "],["multiple-data-sheets.html", "2.4 Multiple Data Sheets", " 2.4 Multiple Data Sheets If the user wishes to have multiple data sheets (for static data vs assessment data) then multiple data dictionaries can be used. The user simply creates a copy of the DataDictionary sheet and creates a different data entry sheet. It will be obvious which dictionaries belong with which data entry sheets by looking at the variables. A workbook with multiple sheets "],["the-exceldata-package.html", "3 The exceldata package", " 3 The exceldata package The exceldata package is a small companion to the DataDictionary workbook. The purpose is to read in the data dictionary and the data entry sheets and then to perform range checks on all the variables. The DataDictionary file does not prevent data entry errors, users can still copy and paste bad values into the sheet. Workflow of the exceldata package "],["import-the-data-dictionary.html", "3.1 Import the Data Dictionary", " 3.1 Import the Data Dictionary The readDataDict function will import the dictionary file. This is slightly more useful than just using readxl::read_excel because checks will be performed to ensure the dictionary is complete and dates will be converted to easy to read text strings. The file and sheetname must be specified. Optional Arguments: colnames Column names of the DataDictionary, defaults to those used in the Excel template range allows a specified range of the sheet to be imported (ie range = A1:F10) origin enables the origin of Excel dates to be set (defaults to 30 December 1899) !readDataDict must be run before readExcelData "],["import-the-data.html", "3.2 Import the Data", " 3.2 Import the Data The readExcelData function will import the data, using the specifications provided in the data dictionary. Again, this should be slightly more useful than a readxl::read_excel because: dates will be imported nicely variables not in the data dictionary will be removed there is an option to store any import warnings, which may be useful to send to the user the data can be read in strictly, setting all values that fall outside the allowed range to NA (This can be useful if users insist on using missing value codes) The file and sheetname, as well as the object returned by the readDataDict function must be specified. Optional Arguments: range allows a specified range of the sheet to be imported (ie range = A1:AB102) origin enables the origin of Excel dates to be set (defaults to 30 December 1899) saveWarnings will return a list with the data frame and the import warnings (if there are any) setErrorsMissing will set all values out of range to NA but this should only be done after running checkData! "],["perform-checks.html", "3.3 Perform Checks", " 3.3 Perform Checks The checkData function will simply check the data against the data dictionary. This requires the outputs of readDataDict and readExcelData. The checkData function will check for duplicate rows and check that all numeric, integer, date, code and category variables meet the requirements of the data dictionary. It does not check the data types, because these are enforced by the readExcelData function. The outputs from readDataDict and readExcelData are required. Optional Argument: id can be used to indicate the patient identifier (ie id =SubjectID) which will provide errors for each id, instead of by row number checkData returns a list with three elements: a data frame containiny all the errors (rows and columns without errors are removed) a two-column data frame with Variable Names in one column and the location of errors in the second (either row numbers or IDs if provided) a two-column data frame with Row Numbers (or IDs) in one columns and the variable containing errors in the second column. "],["create-factor-variables.html", "3.4 Create Factor Variables", " 3.4 Create Factor Variables The addFactorVariables function will rename all the code and category variables suffixed with _orig (so ecog becomes ecog_orig) and create factor variables using the codes provided in the data dictionary as the factor levels and labels. "],["information-for-users-of-the-data-dictionary.html", "4 Information for Users of the Data Dictionary", " 4 Information for Users of the Data Dictionary Good science requires good data! This is a guide to using the Excel macro-enabled template DataDictionary.xlsm What isnt entered cant be analysed, but conversely, there is no need to provide multiple variables containing the same information (ie age and age categories). The over-arching principles are simple: Enter data as completely and accurately as possible Dont enter data twice The data dictionary describes the data in your data file. Example Data Dictionary "],["data-dictionary-1.html", "4.1 Data Dictionary", " 4.1 Data Dictionary 4.1.1 Variable names: Should be short and meaningful, descriptions can be put in the data dictionary Must begin with a letter Should not contain special characters or spaces, except for an underscore _. Long survey questions should be placed in the description. Under the variable name, either a shortened version, or simply Q1, Q2, etc. Bad Variable Names Good Variable Names patient date in clinic clinic_date pre-treatment ECOG ECOG_pre 4.1.2 Types of Data 4.1.2.1 Numeric Data Enter continuous data, such as Age or Weight as a single numeric field Do not enter both Age and Age Category. Instead, enter age and specify AgeCat as a calculated variable Entering data once reduces the amount of data entry and the potential for errors. 4.1.2.2 Categorical Data Enter the Levels of categorical and code variables in the order you would like them presented in (ie CR=complete recovery, PR=partial recovery,SD=stable disease,PD=progressive disease) Categorical data can be entered as numbers, letters or abbreviations instead of text Categories are entered separate by spaces Example: T1,T2,T3,T4 Codes are entered in the data dictionary in the format code=label separated by spaces Examples: 1=Female, 2=Male CR= Complete Recovery, PR= Partial Recovery, SD = Stable Disease, PD = Progressive Disease 4.1.2.3 Dates Should be entered in an unambiguous format ie 01-Jan-2020. This ensures that there is no confusion about the ordering of the month and the day and makes data checking and cleaning easier. 4.1.3 Variable Ranges All date, integer and numeric values should have ranges specified. These should correspond to inclusion and exclusion criteria for your study, or natural values the variable can take. If you dont know the upper limit (ie of a biomarker), then put in the maximum reasonable value. Values above this will be flagged and you can adjust the maximum to include them if you wish. The Minimum and Maximum can be: values (ie 40) variables names (if you want the minimum date of death to be DxDate for example) for date variables you can enter today to allow all dates up to the date of data entry "],["calculations.html", "4.2 Calculations", " 4.2 Calculations All calculations can be performed by the biostatistics department. These will be done in code and are easily reproduced and re-calculated if there are changes to the data. This saves time and increases data quality. Examples of some variables that can be easily calculated: Age (from Date of Birth and Assessment Date) Overall Survival (from Date of Diagnosis and Date of Death) Survival Status (from Date of Death and Last Follow-up) Age or BMI categories from raw data Do not do calculations in Excel. Instead, specify re-codings and calculations in your statistical analysis plan and/or the data dictionary "],["revising-data.html", "4.3 Revising Data", " 4.3 Revising Data 4.3.1 Revising Ranges If you need to change the maximum, minimum or allowed levels or codes for a variable simply make the changes in the DataDictionary sheet and click the Re-format Existing Sheet button. This will update the validation rules and conditional formatting to reflect the new ranges. 4.3.2 Revising Data If you notice an error, this should be corrected in your file and re-sent to us with the date in the filename. This ensures all the data is correct and up to date. Please do not change the layout of the data entry table! "],["longitudinal-data.html", "4.4 Longitudinal Data", " 4.4 Longitudinal Data If data is repeatedly collected on patients, each observation or assessment should be in a separate row. This makes data checking and cleaning simpler, and reduces the size of your data dictionary because there are fewer variables. Example of data in long format. There is one entry for each observation Static variables, like sex and age, or variables that were collected at a single time point can be entered in a separate sheet. "],["wide-format.html", "4.5 Wide Format", " 4.5 Wide Format This format is discouraged, but if data are already entered in wide format, with one row per patient then the variable names should be consistent across the time points, as shown below. Example of data in wide format. Each person is in a row and each assessment has a group of columns "],["frequently-asked-questions.html", "4.6 Frequently Asked Questions", " 4.6 Frequently Asked Questions My data is already in an Excel list from an online capture system, do I still need to enter the specifications? Yes, but this should be pretty quick. The reason that we need the specifications is to know the appropriate ordering for the data. When the data is imported, a variable with levels such as 0-2 years, 3-5 years, 5-10 years and 10+ years cant be ordered correctly without a specification. You can use the UNIQUE function in Excel to extract all the unique values from a column (ie =UNIQUE(A2:A50) to get the unique values in column A up to row 50). I have a lot of variables and I dont want to enter specifications for all of them! It is essential to provide specification for all your variables, but here are some tips to help: 1. Include only the variables you would like analysed in your DataDictionary. 1. If you still have a lot of variables, it is likely that a number of them will have the same type and range, so you can copy and paste those to save time. 1. If you have a lot of variables with spaces or special characters, place the original variable name in the description field, and give your variables simple names - these can be as simple as q1, q2, etc (you dont need to type those, Excel will allow you to highlight a few and then drag down automatically renaming to q3, q4 etc). "]]
